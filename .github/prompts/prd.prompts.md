# KubeZ - Kubernetes 多集群管理平台

## 产品需求文档 (PRD) - MVP 版本

**文档版本**: v1.0-MVP  
**创建日期**: 2025年12月1日  
**产品目标**: 提供核心的 Kubernetes 多集群管理能力

---

## 1. 产品概述

### 1.1 产品定位

KubeZ 是一款轻量级的 Kubernetes 多集群管理平台，专注于核心管理功能。MVP 版本提供集群统一管理、基础监控和日志查看能力。

### 1.2 目标用户

- **DevOps 工程师**: 管理多个 Kubernetes 集群，查看状态和日志
- **开发人员**: 查看应用运行状态和日志

### 1.3 核心价值

- 在单一界面管理多个 Kubernetes 集群
- 实时查看集群、节点、Pod 的运行状态  
- 快速查看容器日志进行问题排查

---

## 2. MVP 核心功能

### 2.1 多集群管理

#### 2.1.1 集群接入

**功能描述**: 导入并管理多个 Kubernetes 集群

**核心功能**:

- 通过 kubeconfig 文件导入集群
- 自动测试集群连接
- 设置集群名称和标签
- 编辑和删除集群

**界面要求**:

- 提供导入表单
- 显示连接测试结果
- 列表展示所有集群

#### 2.1.2 集群列表

**功能描述**: 展示所有集群的状态和基本信息

**核心功能**:

- 显示集群状态（在线/离线）
- 显示节点数量
- 显示 Pod 总数  
- 显示集群版本
- 支持搜索和筛选
- 点击进入集群详情

#### 2.1.3 集群切换

**功能描述**: 在不同集群之间快速切换

**核心功能**:

- 全局集群选择器（顶部导航栏）
- 显示当前选中的集群
- 下拉菜单展示所有可用集群
- 切换后自动刷新当前页面数据
- 记住用户最后选择的集群

**界面要求**:

- 集群选择器显示集群名称和状态图标
- 支持键盘快捷键切换（可选）
- 切换时显示加载状态

#### 2.1.4 集群健康检查

**功能描述**: 定期检测集群连接状态和健康度

**核心功能**:

- 自动检测集群 API Server 连通性
- 显示集群响应时间
- 检测集群证书有效期
- 连接失败时显示错误信息
- 支持手动触发健康检查

**健康指标**:

- 连接状态：正常/异常/超时
- API 响应时间
- 证书剩余有效期（天数）

#### 2.1.5 集群对比视图

**功能描述**: 同时查看多个集群的关键指标

**核心功能**:

- 并排显示所有集群的卡片
- 每个卡片显示关键指标（节点数、Pod 数、CPU/内存使用率）
- 支持按指标排序（如按 CPU 使用率）
- 快速识别异常集群（状态图标和颜色标识）
- 点击卡片进入集群详情

**界面要求**:

- 卡片式布局，每行 3-4 个卡片
- 使用颜色标识集群状态（绿色=正常，红色=异常，黄色=警告）
- 显示关键指标的简化图表

### 2.2 命名空间管理

#### 2.2.1 命名空间列表

**功能描述**: 查看和切换集群中的命名空间

**核心功能**:

- 显示所有命名空间列表
- 显示每个命名空间的资源数量（Pod、Deployment、Service）
- 命名空间筛选器（全局切换）
- 支持搜索命名空间

**界面要求**:

- 下拉选择器（全局导航栏）
- 命名空间列表页面

### 2.3 集群监控

#### 2.3.1 集群概览

**功能描述**: 展示集群整体运行状态

**核心指标**:

- CPU 使用率（百分比）
- 内存使用率（百分比）
- Pod 状态统计（运行/异常/等待）
- 节点状态统计（就绪/未就绪）

**时间范围**:

- 最近 1 小时
- 最近 24 小时
- 最近 7 天

#### 2.3.2 节点列表

**功能描述**: 查看集群中所有节点的状态

**核心信息**:

- 节点名称
- 节点状态（Ready/NotReady）
- CPU 使用率
- 内存使用率
- Pod 数量

#### 2.3.3 Pod 列表

**功能描述**: 查看集群中所有 Pod 的状态

**核心信息**:

- Pod 名称
- 命名空间
- 状态（Running/Pending/Failed/CrashLoopBackOff 等）
- 重启次数
- 所在节点
- 创建时间

**操作**:

- 查看 Pod 详情
- 查看 Pod 日志
- 查看 Pod 事件
- 重启 Pod（删除 Pod）

### 2.4 日志查看

#### 2.4.1 实时日志

**功能描述**: 查看 Pod 容器的实时日志

**核心功能**:

- 实时显示日志流
- 自动滚动到最新
- 支持暂停/恢复
- 选择容器（多容器 Pod）
- 下载日志

**界面要求**:

- 类似终端的日志显示
- 清晰的时间戳
- 容器选择下拉框

#### 2.4.2 历史日志

**功能描述**: 查询历史日志

**核心功能**:

- 指定时间范围查询
- 显示最近 1000 行
- 关键词搜索
- 高亮匹配结果

### 2.5 工作负载查看

#### 2.5.1 Deployment

**功能描述**: 查看 Deployment 列表和详情

**核心信息**:

- Deployment 名称
- 命名空间
- 副本数（期望/当前/可用）
- 镜像
- 更新时间

#### 2.5.2 Service

**功能描述**: 查看 Service 列表

**核心信息**:

- Service 名称
- 类型（ClusterIP/NodePort/LoadBalancer）
- Cluster IP
- 端口
- 选择器

### 2.6 基础认证

#### 2.6.1 用户登录

**功能描述**: 简单的本地认证

**核心功能**:

- 用户名密码登录
- 会话管理（7天有效期）
- 登出功能

#### 2.6.2 权限控制

**基础角色**:

- **管理员**: 可以管理集群、查看所有资源
- **查看者**: 只能查看，不能修改

---

## 3. MVP 功能范围

✅ 多集群接入和管理  
✅ 集群切换和对比视图  
✅ 集群健康检查  
✅ 命名空间管理和切换  
✅ 集群、节点、Pod 基础监控  
✅ 实时日志和历史日志查看  
✅ 工作负载资源浏览（Deployment、Service）  
✅ Pod 基础操作（重启）  
✅ 简单的用户认证和权限

---

## 4. 用户界面要求

### 4.1 整体布局

- 顶部：全局导航栏（Logo、**集群切换选择器**、命名空间选择器、用户菜单）
- 左侧：功能导航（集群、监控、日志、工作负载）
- 主区域：内容展示区

### 4.2 核心页面

**首页（集群对比视图）**:

- 显示所有集群卡片（并排布局）
- 每个卡片显示：名称、状态图标、节点数、Pod 数、CPU/内存使用率
- 支持按指标排序和筛选
- 点击卡片进入集群详情

**集群详情页**:

- Tab 切换：概览、节点、Pod、工作负载
- 概览显示关键指标和图表
- 节点和 Pod 以表格形式展示

**日志查看页**:

- 左侧：资源树形选择（命名空间 > Pod > 容器）
- 右侧：日志显示区和搜索框

### 4.3 交互要求

- 加载状态显示骨架屏或加载动画
- 操作成功显示提示消息（3秒自动消失）
- 错误显示清晰的错误信息
- 列表支持搜索和排序

---

## 5. MVP 验收标准

### 5.1 功能验收

- ✅ 可以成功接入 3+ 个集群
- ✅ 可以通过全局选择器快速切换集群
- ✅ 可以在首页对比查看所有集群状态
- ✅ 可以实时查看集群健康状态和连接性
- ✅ 可以查看集群 API 响应时间和证书有效期
- ✅ 可以查看和切换命名空间
- ✅ 可以查看所有节点和 Pod
- ✅ 可以重启 Pod
- ✅ 可以查看 Pod 实时日志
- ✅ 可以搜索日志内容
- ✅ 可以查看 Deployment 和 Service

### 5.2 性能验收

- 页面加载时间 < 3 秒
- 集群切换响应 < 1 秒
- 集群健康检查周期：30 秒自动检测
- 日志查询响应 < 2 秒  
- 支持管理 10 个集群
- 单集群支持 100+ 节点
- 支持 10 个并发用户

### 5.3 兼容性验收

- 支持 Chrome、Firefox、Safari 最新版本
- 支持 Kubernetes 1.20 - 1.28
- 支持主流云厂商的 Kubernetes 服务

---

## 6. 术语表

| 术语 | 说明 |
|------|------|
| Cluster | Kubernetes 集群 |
| Node | 集群中的节点（物理机或虚拟机） |
| Pod | 最小的可部署单元，包含一个或多个容器 |
| Deployment | 声明式的 Pod 管理器 |
| Service | 服务，提供稳定的网络访问 |
| Namespace | 命名空间，用于资源隔离 |
| kubeconfig | Kubernetes 集群访问配置文件 |
